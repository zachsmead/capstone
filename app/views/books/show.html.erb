<head>
    <title><%= @book.title %></title>
    <script src="<%= @book.book_cloud_url %>"></script>
    <script src="Chart.js"></script>

    
    <!-- <script src="https://s3-us-west-1.amazonaws.com/projectgutenbergtest/book_clouds/pride_and_prejudice.js"></script> -->
</head>

<body>
  <div class="col-md-12" style="margin-bottom: 100px;">

    <div class="header-box" style="padding-bottom: 0px; margin-top: 30px;">
      <h3>
        <a class="header-link" href="<%= @book.url %>"><%= @book.title %></a>
          <div class="header-subsection-divider">
            |
          </div>
          <div class="header-subsection">
            wordcloud
          </div>
      </h3>
    </div>

    <div class="example_div"></div>

    <script type="text/javascript">
      // var tooltip = d3.select("body")
      //   .append("div")
      //   .style("position", "absolute")
      //   .style("z-index", "10")
      //   .style("visibility", "hidden")
      //   .text("a simple tooltip");
        
      // var sampleSVG = d3.select(".example_div")
      //   .append("svg:svg")
      //   .attr("class", "sample")
      //   .attr("width", 300)
      //   .attr("height", 300);    
        
      // d3.select(".example_div svg")
      //   .append("svg:circle")
      //   .attr("stroke", "black")
      //   .attr("fill", "aliceblue")
      //   .attr("r", 50)
      //   .attr("cx", 52)
      //   .attr("cy", 52)
      //   .on("mouseover", function(){return tooltip.style("visibility", "visible");})
      //   .on("mousemove", function(){return tooltip.style("top", (event.pageY-10)+"px").style("left",(event.pageX+10)+"px");})
      //   .on("mouseout", function(){return tooltip.style("visibility", "hidden");});
    </script>



    <div class="card" id="wordcloud" style="margin-top: 30px;"></div>

    <div class="header-box" style="padding-bottom: 10px; margin-top: 100px;"> <!-- stats header-->
      <h3>
        <a class="header-link" href="<%= @book.url %>"><%= @book.title %></a>
          <div class="header-subsection-divider">
            |
          </div>
          <div class="header-subsection">
            stats
          </div>
      </h3>
    </div> <!-- end stats header -->


    <chartjs-doughnut></chartjs-doughnut>

    <div id="text-analysis">
        <%= @emotions_summary %>
    </div>

    

    <%= form_tag "/book_likes", style:"display: inline-block; padding-top: 15px; padding-left: 100px;", method: :post do %>
      <input type="hidden" name="book_id" value="<%= @book.id %>">
      <button type="submit" class="btn btn-danger book-button-short" style="">LIKE</button>
    <% end %>

  </div>
  
</body>

<script>
  d3.wordcloud()
    .size([1180, 400])
    .spiral('archimedean')
    .scale('sqrt')
    .font('Lucida-Sans-Unicode')
    .fill(d3.scale.ordinal().range(["#00770c", "#0e661e", "#048c1c", "#1ebc3a", "#40ce59", "#1fb72e"])) // green
    // .fill(d3.scale.ordinal().range(["#020202", "#2d2d2d", "#545454", "#7a7a7a", "#9e9e9e", "#aaaaaa"])) // grayscale
    // .fill(d3.scale.ordinal().range(["#080063", "#180e87", "#2a1eb2", "#4236c4", "#5e53d1", "#8d83f7"])) // blue
    // .fill(d3.scale.ordinal().range(["#4016fc", "#e2122d", "#136300", "#ad42f4", "#f77810", "#fc077d"])) // rainbow
    .words(words)
    .onwordclick(function(d, i) {
      d3.tip().show();
    })
    .start();
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.3.0/Chart.js"></script>
<script src="https://raw.githubusercontent.com/hchstera/vue-charts/master/dist/vue-charts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.0.3/vue.min.js"></script>
<script>
    Vue.use(VueCharts);
    const app = new Vue({
        el: '#app'
    });
</script>